<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý dữ liệu - HUIT Student Management</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/style.css">
    
    
</head>
<body>
    <!-- Main Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                <div class="sidebar-brand">
                    <span style="font-size: 20px;"> HUIT Academic <br>Grade Analysis</span>
                </div>
            </div>
            

            <!-- Navigation Menu -->
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link ">
                        <i data-lucide="home" class="nav-icon"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="statistics.html" class="nav-link ">
                        <i data-lucide="bar-chart-3" class="nav-icon"></i>
                        <span>Thống kê chi tiết</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="students.html" class="nav-link ">
                        <i data-lucide="users" class="nav-icon"></i>
                        <span>Danh sách sinh viên</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/search" class="nav-link ">
                        <i data-lucide="search" class="nav-icon"></i>
                        <span>Tìm kiếm cơ bản</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="advanced_search.html" class="nav-link ">
                        <i data-lucide="zap" class="nav-icon"></i>
                        <span>Tìm kiếm nâng cao</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="compare.html" class="nav-link ">
                        <i data-lucide="git-compare" class="nav-icon"></i>
                        <span>So sánh dữ liệu</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/alerts" class="nav-link ">
                        <i data-lucide="alert-triangle" class="nav-icon"></i>
                        <span>Cảnh báo học vụ</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/reports" class="nav-link ">
                        <i data-lucide="file-text" class="nav-icon"></i>
                        <span>Báo cáo & Xuất file</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="data_management.html" class="nav-link ">
                        <i data-lucide="database" class="nav-icon"></i>
                        <span>Quản lý dữ liệu</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navigation -->
            <header class="top-nav">
                <div class="nav-left">
                    <h1 class="page-title">Quản lý dữ liệu</h1>
                </div>
                <div class="nav-right">
                    <div class="search-box">
                        <i data-lucide="search" class="search-icon"></i>
                        <input type="text" placeholder="Tìm kiếm..." id="globalSearch">
                    </div>
                    <div class="user-info">
                        <div class="date-time">
                            <div class="date" id="currentDate"></div>
                            <div class="time" id="currentTime"></div>
                        </div>
                        <div class="user-avatar">
                            <i data-lucide="user" class="avatar-icon"></i>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Page Content -->
            <div class="content-wrapper">
                
                    
                
                
                
<!-- File Upload Section -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="upload"></i>
            Tải lên dữ liệu
        </h3>
    </div>
    
    <div class="file-upload" id="fileUploadArea">
        <div style="margin-bottom: 1rem;">
            <i data-lucide="file-plus" style="width: 48px; height: 48px; color: #64748b;"></i>
        </div>
        <h4 style="color: #334155; margin-bottom: 0.5rem;">Kéo thả file hoặc click để chọn</h4>
        <p style="color: #64748b; margin-bottom: 1rem;">
            Hỗ trợ file CSV, Excel (.xls, .xlsx). Tối đa 16MB
        </p>
        <input type="file" id="fileInput" accept=".csv,.xls,.xlsx" style="display: none;">
        <div class="btn btn-primary">
            <i data-lucide="folder"></i>
            Chọn file
        </div>
    </div>
</div>


<!-- Current Data Info -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="database"></i>
            Thông tin dữ liệu hiện tại
        </h3>
        <div>
            <button class="btn btn-danger" onclick="clearData()">
                <i data-lucide="trash-2"></i>
                Xóa dữ liệu
            </button>
        </div>
    </div>
    
    <div class="grid grid-2">
        <div class="data-info-item">
            <div class="info-label">Tổng số sinh viên</div>
            <div class="info-value">3221</div>
        </div>
        <div class="data-info-item">
            <div class="info-label">Số cột dữ liệu</div>
            <div class="info-value">13</div>
        </div>
        <div class="data-info-item">
            <div class="info-label">Kích thước dữ liệu</div>
            <div class="info-value">2.1 MB</div>
        </div>
        <div class="data-info-item">
            <div class="info-label">Cập nhật lần cuối</div>
            <div class="info-value">Hôm nay</div>
        </div>
    </div>
    
    
</div>

<!-- Data Actions -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="settings"></i>
            Thao tác dữ liệu
        </h3>
    </div>
    
    <div class="grid grid-3">
        <button class="btn btn-secondary" onclick="exportData('csv')">
            <i data-lucide="download"></i>
            Xuất CSV
        </button>
        <button class="btn btn-secondary" onclick="exportData('excel')">
            <i data-lucide="download"></i>
            Xuất Excel
        </button>
        <button class="btn btn-secondary" onclick="validateData()">
            <i data-lucide="check-circle"></i>
            Kiểm tra dữ liệu
        </button>
        <button class="btn btn-secondary" onclick="showDataPreview()">
            <i data-lucide="eye"></i>
            Xem trước
        </button>
        <button class="btn btn-secondary" onclick="showDataStats()">
            <i data-lucide="bar-chart"></i>
            Thống kê cơ bản
        </button>
        <button class="btn btn-secondary" onclick="cleanData()">
            <i data-lucide="refresh-cw"></i>
            Làm sạch dữ liệu
        </button>
    </div>
</div>



<!-- Sample Data Section -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="file-text"></i>
            Dữ liệu mẫu
        </h3>
    </div>
    
    <p style="color: #64748b; margin-bottom: 1.5rem;">
        Tải xuống file dữ liệu mẫu để hiểu định dạng cần thiết
    </p>
    
    <div class="grid grid-2" style="max-width: 400px;">
        <button class="btn btn-secondary" onclick="downloadSample('csv')">
            <i data-lucide="download"></i>
            Tải mẫu CSV
        </button>
        <button class="btn btn-secondary" onclick="downloadSample('excel')">
            <i data-lucide="download"></i>
            Tải mẫu Excel
        </button>
    </div>
</div>

            </div>
        </main>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">Đang tải...</div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="static/js/dashboard.js"></script>
    
<style>
.data-info-item {
    background: #f8fafc;
    padding: 1.5rem;
    border-radius: 8px;
    text-align: center;
}

.info-label {
    font-size: 0.875rem;
    color: #64748b;
    margin-bottom: 0.5rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 500;
}

.info-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1e40af;
}

.columns-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
}

.column-tag {
    display: inline-flex;
    align-items: center;
    background: #eff6ff;
    color: #1d4ed8;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.875rem;
    font-weight: 500;
    border: 1px solid #bfdbfe;
}

.column-tag i {
    width: 14px;
    height: 14px;
    margin-right: 0.5rem;
}
</style>

<script>
function clearData() {
    if (confirm('Bạn có chắc chắn muốn xóa toàn bộ dữ liệu? Hành động này không thể hoàn tác.')) {
        // Implement clear data functionality
        console.log('Clearing data...');
    }
}

function exportData(format) {
    window.dashboardApp.showLoading();
    
    // Simulate export
    setTimeout(() => {
        window.dashboardApp.hideLoading();
        window.dashboardApp.showAlert('success', `Đã xuất dữ liệu định dạng ${format.toUpperCase()}`);
    }, 2000);
}

function validateData() {
    window.dashboardApp.showLoading();
    
    // Simulate validation
    setTimeout(() => {
        window.dashboardApp.hideLoading();
        window.dashboardApp.showAlert('success', 'Dữ liệu hợp lệ - Không có lỗi');
    }, 1500);
}

function showDataPreview() {
    window.location.href = '/students';
}

function showDataStats() {
    window.location.href = '/statistics';
}

function cleanData() {
    if (confirm('Làm sạch dữ liệu sẽ xóa các dòng trống và chuẩn hóa định dạng. Tiếp tục?')) {
        window.dashboardApp.showLoading();
        
        setTimeout(() => {
            window.dashboardApp.hideLoading();
            window.dashboardApp.showAlert('success', 'Đã làm sạch dữ liệu thành công');
        }, 2000);
    }
}

function downloadSample(format) {
    // Create sample data
    const sampleData = [
        ['STT', 'Họ và tên', 'MSSV', 'Lớp', 'Điểm TB', 'Xếp loại'],
        ['1', 'Nguyễn Văn A', '2021001', 'CNTT01', '8.5', 'Giỏi'],
        ['2', 'Trần Thị B', '2021002', 'CNTT01', '7.2', 'Khá'],
        ['3', 'Lê Văn C', '2021003', 'CNTT02', '6.8', 'Khá']
    ];
    
    if (format === 'csv') {
        const csvContent = sampleData.map(row => row.join(',')).join('\n');
        const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = 'mau_du_lieu_sinh_vien.csv';
        link.click();
    } else {
        window.dashboardApp.showAlert('info', 'Tính năng xuất Excel đang được phát triển');
    }
}
</script>

    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Update date/time
        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString('vi-VN');
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('vi-VN', {hour: '2-digit', minute: '2-digit'});
        }
        
        updateDateTime();
        setInterval(updateDateTime, 60000); // Update every minute
        
        // Load data info
        async function loadDataInfo() {
            try {
                const response = await fetch('/api/dashboard-data');
                if (response.ok) {
                    const data = await response.json();
                    const statsEl = document.getElementById('dataStats');
                    statsEl.innerHTML = `
                        <div>Sinh viên: ${data.total_students || 0}</div>
                        <div>Lớp: ${data.total_classes || 0}</div>
                        <div>Điểm TB: ${data.average_score || 0}</div>
                        <div>Tỷ lệ đậu: ${data.pass_rate || 0}%</div>
                        <div>Cập nhật: ${data.recent_updates || 'N/A'}</div>
                    `;
                }
            } catch (error) {
                console.error('Error loading data info:', error);
            }
        }
        
        // Load data info on page load
        document.addEventListener('DOMContentLoaded', loadDataInfo);
    </script>

    <script>
        // Static mode notice
        if (typeof window !== 'undefined') {
            console.log('Running in static mode - API endpoints disabled');
            
            // Disable form submissions
            document.addEventListener('DOMContentLoaded', function() {
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        alert('This is a static demo. Form submission is disabled.');
                    });
                });
                
                // Add static mode banner
                const banner = document.createElement('div');
                banner.innerHTML = `
                    <div style="background: #ff9800; color: white; padding: 10px; text-align: center; position: fixed; top: 0; left: 0; right: 0; z-index: 9999;">
                        📌 Static Demo Mode - Some features are disabled. 
                        <a href="https://github.com/InfinityZero3000/student-management-app" style="color: white; text-decoration: underline;">View Full Version</a>
                    </div>
                `;
                document.body.insertBefore(banner, document.body.firstChild);
                
                // Adjust body padding to account for banner
                document.body.style.paddingTop = '50px';
            });
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th·ªëng k√™ chi ti·∫øt - HUIT Student Management</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/style.css">
    
    
</head>
<body>
    <!-- Main Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <!-- Header -->
            <div class="sidebar-header">
                <div class="sidebar-brand">
                    <span style="font-size: 20px;"> HUIT Academic <br>Grade Analysis</span>
                </div>
            </div>
            

            <!-- Navigation Menu -->
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link ">
                        <i data-lucide="home" class="nav-icon"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="statistics.html" class="nav-link ">
                        <i data-lucide="bar-chart-3" class="nav-icon"></i>
                        <span>Th·ªëng k√™ chi ti·∫øt</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="students.html" class="nav-link ">
                        <i data-lucide="users" class="nav-icon"></i>
                        <span>Danh s√°ch sinh vi√™n</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/search" class="nav-link ">
                        <i data-lucide="search" class="nav-icon"></i>
                        <span>T√¨m ki·∫øm c∆° b·∫£n</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="advanced_search.html" class="nav-link ">
                        <i data-lucide="zap" class="nav-icon"></i>
                        <span>T√¨m ki·∫øm n√¢ng cao</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="compare.html" class="nav-link ">
                        <i data-lucide="git-compare" class="nav-icon"></i>
                        <span>So s√°nh d·ªØ li·ªáu</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/alerts" class="nav-link ">
                        <i data-lucide="alert-triangle" class="nav-icon"></i>
                        <span>C·∫£nh b√°o h·ªçc v·ª•</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="/reports" class="nav-link ">
                        <i data-lucide="file-text" class="nav-icon"></i>
                        <span>B√°o c√°o & Xu·∫•t file</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="data_management.html" class="nav-link ">
                        <i data-lucide="database" class="nav-icon"></i>
                        <span>Qu·∫£n l√Ω d·ªØ li·ªáu</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navigation -->
            <header class="top-nav">
                <div class="nav-left">
                    <h1 class="page-title">Th·ªëng k√™ chi ti·∫øt</h1>
                </div>
                <div class="nav-right">
                    <div class="search-box">
                        <i data-lucide="search" class="search-icon"></i>
                        <input type="text" placeholder="T√¨m ki·∫øm..." id="globalSearch">
                    </div>
                    <div class="user-info">
                        <div class="date-time">
                            <div class="date" id="currentDate"></div>
                            <div class="time" id="currentTime"></div>
                        </div>
                        <div class="user-avatar">
                            <i data-lucide="user" class="avatar-icon"></i>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Page Content -->
            <div class="content-wrapper">
                
                    
                
                
                
<!-- T·ªïng quan th·ªëng k√™ -->
<div class="grid grid-4">
    <div class="card metric-card">
        <div class="metric-icon" style="background-color: #2594e9ff;">
            <i data-lucide="users"></i>
        </div>
        <div class="metric-content">
            <h3 id="totalStudentsDetail">0</h3>
            <p>T·ªïng sinh vi√™n</p>
        </div>
    </div>
    <div class="card metric-card">
        <div class="metric-icon" style="background-color: #10b981;">
            <i data-lucide="graduation-cap"></i>
        </div>
        <div class="metric-content">
            <h3 id="averageGPA">0</h3>
            <p>GPA trung b√¨nh</p>
        </div>
    </div>
    <div class="card metric-card">
        <div class="metric-icon" style="background-color: #f59e0b;">
            <i data-lucide="trending-up"></i>
        </div>
        <div class="metric-content">
            <h3 id="passRateDetail">0%</h3>
            <p>T·ª∑ l·ªá qua m√¥n</p>
        </div>
    </div>
    <div class="card metric-card">
        <div class="metric-icon" style="background-color: #8b5cf6;">
            <i data-lucide="award"></i>
        </div>
        <div class="metric-content">
            <h3 id="excellentCount">0</h3>
            <p>Sinh vi√™n xu·∫•t s·∫Øc</p>
        </div>
    </div>
</div>

<!-- Ph√¢n t√≠ch chi ti·∫øt -->
<div class="grid grid-2">
    <!-- Ph√¢n b·ªë ƒëi·ªÉm s·ªë chi ti·∫øt -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i data-lucide="bar-chart-3"></i>
                Ph√¢n b·ªë ƒëi·ªÉm s·ªë chi ti·∫øt
            </h3>
        </div>
        <div style="height: 350px; position: relative;">
            <canvas id="detailedScoreChart"></canvas>
        </div>
        <div class="chart-stats" id="scoreStats">
            <!-- Stats will be populated by JavaScript -->
        </div>
    </div>

    <!-- Ph√¢n t√≠ch xu h∆∞·ªõng -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i data-lucide="trending-up"></i>
                Xu h∆∞·ªõng h·ªçc t·∫≠p
            </h3>
        </div>
        <div style="height: 350px; position: relative;">
            <canvas id="trendChart"></canvas>
        </div>
    </div>
</div>

<!-- Ph√¢n t√≠ch theo l·ªõp -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="school"></i>
            Ph√¢n t√≠ch theo l·ªõp h·ªçc
        </h3>
        <div class="card-actions">
            <select id="classFilter" class="form-select">
                <option value="">T·∫•t c·∫£ l·ªõp</option>
            </select>
        </div>
    </div>
    <div class="grid grid-2">
        <div style="height: 400px; position: relative;">
            <canvas id="classPerformanceChart"></canvas>
        </div>
        <div id="classAnalysis" class="analysis-panel">
            <h4> Ph√¢n t√≠ch chi ti·∫øt l·ªõp</h4>
            <div id="classMetrics">
                <!-- Class metrics will be populated here -->
            </div>
        </div>
    </div>
</div>

<!-- B·∫£ng x·∫øp h·∫°ng -->
<div class="grid grid-2">
    <!-- Top performers -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i data-lucide="trophy"></i>
                 TOP sinh vi√™n xu·∫•t s·∫Øc
            </h3>
        </div>
        <div id="topStudents" class="ranking-list">
            <!-- Top students will be populated here -->
        </div>
    </div>

    <!-- Bottom performers -->
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">
                <i data-lucide="alert-triangle"></i>
                Sinh vi√™n c·∫ßn h·ªó tr·ª£
            </h3>
        </div>
        <div id="lowPerformers" class="ranking-list">
            <!-- Low performers will be populated here -->
        </div>
    </div>
</div>

<!-- Th·ªëng k√™ n√¢ng cao -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="calculator"></i>
            Th·ªëng k√™ n√¢ng cao
        </h3>
    </div>
    <div class="grid grid-3">
        <div class="stat-box">
            <h4>ƒê·ªô l·ªách chu·∫©n</h4>
            <div class="stat-value" id="standardDeviation">0</div>
            <p class="stat-desc">M·ª©c ƒë·ªô ph√¢n t√°n ƒëi·ªÉm s·ªë</p>
        </div>
        <div class="stat-box">
            <h4>H·ªá s·ªë bi·∫øn thi√™n</h4>
            <div class="stat-value" id="coefficientVariation">0%</div>
            <p class="stat-desc">T√≠nh ƒë·ªìng ƒë·ªÅu c·ªßa ƒëi·ªÉm</p>
        </div>
        <div class="stat-box">
            <h4>Skewness</h4>
            <div class="stat-value" id="skewness">0</div>
            <p class="stat-desc">ƒê·ªô l·ªách ph√¢n b·ªë</p>
        </div>
    </div>
    
    <div class="grid grid-2" style="margin-top: 2rem;">
        <div>
            <h4>Ph√¢n t√≠ch t·ª© ph√¢n v·ªã (Quartiles)</h4>
            <div id="quartileAnalysis" class="quartile-container">
                <!-- Quartile analysis will be populated here -->
            </div>
        </div>
        <div>
            <h4>Ph√¢n t√≠ch outliers</h4>
            <div id="outlierAnalysis" class="outlier-container">
                <!-- Outlier analysis will be populated here -->
            </div>
        </div>
    </div>
</div>

<!-- Khuy·∫øn ngh·ªã -->
<div class="card">
    <div class="card-header">
        <h3 class="card-title">
            <i data-lucide="lightbulb"></i>
            Khuy·∫øn ngh·ªã v√† ƒë√°nh gi√°
        </h3>
    </div>
    <div id="recommendations" class="recommendations-panel">
        <!-- AI recommendations will be populated here -->
    </div>
</div>

<style>
.metric-card {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.metric-icon {
    width: 60px;
    height: 60px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
}

.metric-content h3 {
    font-size: 2rem;
    font-weight: bold;
    margin: 0;
    color: #1e293b;
}

.metric-content p {
    margin: 0;
    color: #64748b;
    font-size: 0.9rem;
}

.chart-stats {
    padding: 1rem;
    background: #f8fafc;
    border-top: 1px solid #e2e8f0;
    margin-top: 1rem;
}

.card-actions {
    display: flex;
    gap: 1rem;
}

.form-select {
    padding: 0.5rem 1rem;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    background: white;
    min-width: 150px;
}

.analysis-panel {
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px;
}

.analysis-panel h4 {
    margin-bottom: 1rem;
    color: #1e293b;
}

.ranking-list {
    max-height: 400px;
    overflow-y: auto;
}

.ranking-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 1rem;
    border-bottom: 1px solid #e2e8f0;
}

.ranking-item:last-child {
    border-bottom: none;
}

.ranking-number {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    color: white;
    font-size: 0.9rem;
}

.ranking-number.gold { background: #f59e0b; }
.ranking-number.silver { background: #6b7280; }
.ranking-number.bronze { background: #92400e; }
.ranking-number.default { background: #2594e9ff; }

.stat-box {
    text-align: center;
    padding: 1.5rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.stat-box h4 {
    margin-bottom: 0.5rem;
    color: #1e293b;
    font-size: 1rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    color: #2594e9ff;
    margin-bottom: 0.5rem;
}

.stat-desc {
    color: #64748b;
    font-size: 0.9rem;
    margin: 0;
}

.quartile-container,
.outlier-container {
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.recommendations-panel {
    padding: 1rem;
}

.recommendation-item {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    padding: 1rem;
    background: #f8fafc;
    border-radius: 8px;
    margin-bottom: 1rem;
    border-left: 4px solid #2594e9ff;
}

.recommendation-icon {
    width: 24px;
    height: 24px;
    color: #2594e9ff;
    flex-shrink: 0;
}

.recommendation-content h5 {
    margin-bottom: 0.5rem;
    color: #1e293b;
}

.recommendation-content p {
    margin: 0;
    color: #64748b;
    line-height: 1.5;
}
</style>

<script>
// Statistics page specific JavaScript will be handled in dashboard.js
document.addEventListener('DOMContentLoaded', function() {
    if (typeof window.statisticsApp !== 'undefined') {
        window.statisticsApp.init();
    }
});
</script>

            </div>
        </main>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text">ƒêang t·∫£i...</div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="static/js/dashboard.js"></script>
    
    
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
        
        // Update date/time
        function updateDateTime() {
            const now = new Date();
            document.getElementById('currentDate').textContent = now.toLocaleDateString('vi-VN');
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('vi-VN', {hour: '2-digit', minute: '2-digit'});
        }
        
        updateDateTime();
        setInterval(updateDateTime, 60000); // Update every minute
        
        // Load data info
        async function loadDataInfo() {
            try {
                const response = await fetch('/api/dashboard-data');
                if (response.ok) {
                    const data = await response.json();
                    const statsEl = document.getElementById('dataStats');
                    statsEl.innerHTML = `
                        <div>Sinh vi√™n: ${data.total_students || 0}</div>
                        <div>L·ªõp: ${data.total_classes || 0}</div>
                        <div>ƒêi·ªÉm TB: ${data.average_score || 0}</div>
                        <div>T·ª∑ l·ªá ƒë·∫≠u: ${data.pass_rate || 0}%</div>
                        <div>C·∫≠p nh·∫≠t: ${data.recent_updates || 'N/A'}</div>
                    `;
                }
            } catch (error) {
                console.error('Error loading data info:', error);
            }
        }
        
        // Load data info on page load
        document.addEventListener('DOMContentLoaded', loadDataInfo);
    </script>

    <script>
        // Static mode notice
        if (typeof window !== 'undefined') {
            console.log('Running in static mode - API endpoints disabled');
            
            // Disable form submissions
            document.addEventListener('DOMContentLoaded', function() {
                const forms = document.querySelectorAll('form');
                forms.forEach(form => {
                    form.addEventListener('submit', function(e) {
                        e.preventDefault();
                        alert('This is a static demo. Form submission is disabled.');
                    });
                });
                
                // Add static mode banner
                const banner = document.createElement('div');
                banner.innerHTML = `
                    <div style="background: #ff9800; color: white; padding: 10px; text-align: center; position: fixed; top: 0; left: 0; right: 0; z-index: 9999;">
                        üìå Static Demo Mode - Some features are disabled. 
                        <a href="https://github.com/InfinityZero3000/student-management-app" style="color: white; text-decoration: underline;">View Full Version</a>
                    </div>
                `;
                document.body.insertBefore(banner, document.body.firstChild);
                
                // Adjust body padding to account for banner
                document.body.style.paddingTop = '50px';
            });
        }
    </script>
</body>
</html>